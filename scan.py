#!/usr/bin/env python3

import sys
import requests
from urllib.parse import urlparse

ARCHIVE_URL = "https://web.archive.org/cdx/search/cdx?url={domain}/*&output=txt&fl=original"

LOGIN_PATHS = (
"/websenderak/",
"/adminloko/",
"/lokoadministrator/",
"/webloko/",
"/webredaktur/",
"/webadministrator/",
"/adminweb/",
"/data/",
"/tinymce/",
"/file-manager/",
"/operator/",
"/-adminweb/",
"/!adminweb/",
"/@adminweb/",
"/adminweb121/",
"/adminweb90/",
"/adminweb145/",
"/khususadmin/",
"/rahasiaadm/",
"/adminweb123123/",
"/adminweb2222/",
"/adminlanel/",
"/adminlanel.php",
"/monitor123.php",
"/masuk.php",
"/css.php",
"/admin1235.php",
"/master.php",
"/1admin/",
"/123admin/",
"/addmin/",
"/home.php",
"/css/",
"/rediect.php",
"/index.php",
"/webpaneladmin123/",
"/registeradm/",
"/register/",
"/member123/",
"/123adminweb/",
"/123paneladminweb/",
"/panelauth1231/",
"/loginadminweb21/",
"/loginadminweb123/",
"/loginadminweb/",
"/webadmin123/",
"/redakturadmin/",
"/paneladminweb/",
"/admloginadm/",
"/4dm1n/",
"/admin12345/",
"/adminweb12/",
"/adminweb111/",
"/adminweb123/",
"/adminweb1/",
"/gangmasuk/",
"/gangadmin/",
"/admredaktur/",
"/adminwebredaktur/",
"/adminredaktur/",
"/sika/",
"/develop/",
"/ketua/",
"/redaktur/",
"/administrator/",
"/user/",
"/users/",
"/dinkesadmin/",
"/retel/",
"/author/",
"/panel/",
"/paneladmin/",
"/panellogin/",
"/redaksi/",
"/cp-admin/",
"/master/",
"/login",
"/master/index.php",
"/master/login.php",
"/operator/index.php",
"/sika/index.php",
"/develop/index.php",
"/ketua/index.php",
"/redaktur/index.php",
"/admin/index.php",
"/administrator/index.php",
"/adminweb/index.php",
"/user/index.php",
"/users/index.php",
"/dinkesadmin/index.php",
"/retel/index.php",
"/author/index.php",
"/panel/index.php",
"/paneladmin/index.php",
"/panellogin/index.php",
"/redaksi/index.php",
"/cp-admin/index.php",
"/operator/login.php",
"/sika/login.php",
"/develop/login.php",
"/ketua/login.php",
"/redaktur/login.php",
"/admin/login.php",
"/administrator/login.php",
"/adminweb/login.php",
"/user/login.php",
"/users/login.php",
"/dinkesadmin/login.php",
"/retel/login.php",
"/author/login.php",
"/panel/login.php",
"/paneladmin/login.php",
"/panellogin/login.php",
"/redaksi/login.php",
"/cp-admin/login.php",
"/terasadmin/",
"/terasadmin/index.php",
"/terasadmin/login.php",
"/rahasia/",
"/rahasia/index.php",
"/rahasia/admin.php",
"/rahasia/login.php",
"/adminpmb/",
"/adminpmb/index.php",
"/adminpmb/login.php",
"/system/",
"/system/index.php",
"/system/login.php",
"/webadmin/",
"/webadmin/index.php",
"/webadmin/login.php",
"/wpanel/",
"/wpanel/index.php",
"/wpanel/login.php",
"/adminpanel/index.php",
"/adminpanel/",
"/adminpanel/login.php",
"/adminkec/",
"/adminkec/index.php",
"/adminkec/login.php",
"/admindesa/",
"/admindesa/index.php",
"/admindesa/login.php",
"/adminkota/",
"/adminkota/index.php",
"/adminkota/login.php",
"/admin123/",
"/admin123/index.php",
"/admin123/login.php",
"/logout/",
"/logout/index.php",
"/logout/login.php",
"/logout/admin.php",
"/sistem/",
"/webpanel/",
"/w3bc0ntr0l/",
"/apanel/",
"/sysadmin/",
"/operator.php",
"/sika.php",
"/develop.php",
"/ketua.php",
"/redaktur.php",
"/admin.php",
"/administrator.php",
"/adminweb.php",
"/user.php",
"/users.php",
"/dinkesadmin.php",
"/retel.php",
"/author.php",
"/panel.php",
"/paneladmin.php",
"/panellogin.php",
"/redaksi.php",
"/cp-admin.php",
"/admin/",
"/file_manager/",
"/laravel-filemanager/",
"/vendor/",
"/OLD/",
"/BACKUP/",
"/adminx/",
"/admin-login.php",
"/policeAdmin/",
"/userweb/",
"/db/admin/",
"/db/admin/login.php",
"/siteadmin",
"/settingweb/",
"/minds/",
"/Site-Manager/",
"/Admin/",
"/s_adminwebX/",
"/panels/",
"/manager/",
"/adm/",
"/superadmin/",
"/tech-admin/",
"/auth/user_login/",
"/AdmIn/",
"/AdminPage.php",
"/adminpage.php",
"/admrtm123/",
"/ereporting/",
"/administrasi/",
"/administrasi.php",
"/webmaster/",
"/admin/login",
"/admin-panel",
"/adminpanel/login",
"/redaktur",
"/redaktur/login",
"/welcome_admin/",
"/masuk_admin/",
"/_admin/",
"/_admin2/",
"/admin1/",
"/admin2/",
"/admin3/",
"/themeadmin/",
"/manager/login.php",
"/admin_/",
"/user/login",
"/user/admin",
"/admin_area",
"/staff/admin/",
"/staff/admin/login.php",
"/staff/admin/login",
"/app/admin/login",
"/redaktur/admin/login",
"/docs/admin/login",
"/easylogin/admin/",
"/ketua/admin",
"/surat/",
"/ketua/admin/login",
"/disdikmtkontenadm12/",
"/adminkey",
"/login_admin.php",
"/adminnew/",
"/adminicl/",
"/adminbaru/",
"/adminhrd/",
"/admin_login.php",
"/panel/login",
"/admin2017/",
"/login_admin/",
"/admin_login/",
"/pdp/admin/",
"/cmsadmin/",
"/halamanmasuk/",
"/cmsuser/",
"/admindinkes/",
"/admindinas/",
"/demo/",
"/admini/",
"/juragan/",
"/jdih/",
"/JDIH/",
"/adminedit/",
"/admins/",
"/Admins/",
"/v1/admin/",
"/v2/admin/",
"/a_admin/",
"/administr8/",
"/admin4_account/",
"/secure/",
"/security/",
"/pemkoadmin/",
"/pemko/",
"/login-page/",
"/admintoko/",
"/login-2/",
"/eklinik/",
"/admin_pmi/",
"/4dmin.php",
"/4dm1n.php",
"/@dm1npu5@t/",
"/adminpusat/",
"/@dm1np3ngd@/",
"/web-admin2/",
"/@dm1nw3b/",
"/bpm4dm1n/",
"/@dm1n/",
"/backend/",
"/zonaadmin/",
"/zonaadm/",
"/management/",
"/pengada/",
"/adminpengada/",
"/adminarea/",
"/crm/",
"/recruitment/",
"/kodim/",
"/4dminweb/",
"/loginadmin/",
"/logadmin.php",
"/admin-kominfo/",
"/admin-kejari/",
"/mantap/",
"/administrivia/",
"/Database_Administration/",
"/WebAdmin/",
"/useradmin/",
"/sysadmins/",
"/system-administration/",
"/administrators/",
"/pgadmin/",
"/directadmin/",
"/staradmin/",
"/ServerAdministrator/",
"/SysAdmin/",
"/administer/",
"/LiveUser_Admin/",
"/sys-admin/",
"/cpanel/",
"/cPanel/",
"/cpanel_file/",
"/platz_login/",
"/rcLogin/",
"/formslogin/",
"/autologin/",
"/support_login/",
"/0manager/",
"/lokoadmin/",
"/0wner/",
"/0wn3r/",
"/2014/",
"/adminwebs/",
"/Adminweb/",
"/dologin/",
"/coc_login/",
"/admin___/",
"/2015/",
"/2016/",
"/admin@set/",
"/admin-assets/",
"/wxadmin/",
"/kpu_admin/",
"/adminassets/",
"/2017/",
"/login.html",
"/operatorr/",
"/loginadmin.html",
"/p3ngadu4n/",
"/halaman/admin/",
"/master/master/",
"/admin/admin",
"/main/",
"/0admin/",
"/4dm1nweb/",
"/4logins/",
"/4dmin/",
"/4dmin_login/",
"/4dmin_login.php",
"/4login.php",
"/4dm1n1str4t0r/",
"/abc/",
"/admin2016/",
"/adminpageonly/",
"/admin-site/",
"/administratorsite/",
"/adminsitus/",
"/admin_area/login.php",
"/adminwww/",
"/wwwadmin/",
"/admincms/",
"/admwebsite/",
"/admcms/",
"/add_admin/",
"/adminok/",
"/adminindex/",
"/virtualadmin/",
"/vpanel/",
"/agussusanto/",
"/v1/",
"/v2/",
"/v3/",
"/teraskita/",
"/_adm1n/",
"/_kpanel/",
"/_staff/",
"/_app/",
"/_admlogin/",
"/_admsite/",
"/administrative/",
"/adm-site/",
"/admweb/",
"/admin~site/",
"/admin-lurah/",
"/admin-dprd/",
"/admin-kecamatan/",
"/admin-pemerintah/",
"/admin_new/",
"/adminsql/",
"/v2/login",
"/adminpro/",
"/admloginuser/",
"/admin_zone/",
"/adm_enter/",
"/aadmin/",
"/aaadmin/",
"/adminold/",
"/AdminTools/",
"/adminboard/",
"/admincp.php",
"/adminoffice/",
"/admin$/",
"/redaktur1/",
"/Admin.php",
"/redaktur2/",
"/_redaktur/",
"/Redaktur/",
"/bpadmin/",
"/dasboard/",
"/master-admin/",
"/4dminW3B/",
"/masteradmin/",
"/masteradm",
"/master-adm/",
"/aturweb/",
"/back4dmin/",
"/login.php",
"/publikasi/",
"/publikasi/login.php",
"/teamadmin/index.php",
"/pintumasuk/",
"/adminweb_setting/",
"/pengelola/web",
"/auth/panel/",
"/manager/adm/",
"/adminpa/",
"/admindisbun/",
"/admin_control/",
"/polda/",
"/admpolda/",
"/adminpolda/",
"/poldaadmin/",
"/admdispenda2016/",
"/admdispenda2017/",
"/adminpage/",
"/editweb/",
"/adminbox/",
"/moderator/",
"/_loginadmin_/",
"/public/login.php",
"/adminkpu/",
"/AdminKpu/",
"/cp/",
"/admincp/",
"/user_login.php",
"/myadmin/",
"/MyAdmin/",
"/adm_login.php",
"/jd-admin/",
"/jd-admin/login.php",
"/adminpart/",
"/local/",
"/adm1n/",
"/adminform/",
"/web/login",
"/login/",
"/cms/",
"/cms/login.php",
"/cms/admin",
"/_admin/kerangka/login.htm",
"/AdminWeb/",
"/admin_jdi/",
"/login/profile",
"/superadmin.php",
"/SuperAdmin/Admin/login.php",
"/SuperAdmin/Admin/",
"/login/loginpage.php",
"/s-admin/",
"/adminlogin",
"/adminlogins/",
"/admins_login/",
"/berita/admin/",
"/news/admin/",
"/newsadmin/",
"/masuk/",
"/masuk/login.php",
"/blog/admin/",
"/administrate/",
"/tour-admin/",
"/alumni/App/",
"/control/",
"/redaksiweb/",
"/Siteadmin/",
"/kelolaweb/",
"/berita/",
"/peraturan/",
"/setting/",
"/login-form/",
"/shop-admin/",
"/ADMIN/",
"/teman/",
"/adm4dep/",
"/zadmin/",
"/xadmin/",
"/adminpusdatin/",
"/adminjdih/",
"/admin-jdih/",
"/tm-admin/",
"/report-admin/",
"/admin@web/",
"/login@web/",
"/report/",
"/sigin/admin/",
"/berita-admin/",
"/web-login.php",
"/admin_negara/",
"/admin-pn/",
"/admin_berita/",
"/kom@ndan2015/",
"/adminpengada/
",
"/register.html",
"/adminlte/",
"/adminxx/",
"/adm2/",
"/adm3/",
"/pages/",
"/sekretariat/",
"/cms-admin/",
"/admin-web/",
"/",
"/meta_login/",
"/manuallogin/",
"/simpleLogin/",
"/loginflat/",
"/utility_login/",
"/showlogin/",
"/login-redirect/",
"/sub-login/",
"/login1/",
"/dir-login/",
"/login_db/",
"/xlogin/",
"/smblogin/",
"/customer_login/",
"/UserLogin/",
"/login-us/",
"/acct_login/",
"/admin_area/",
"/bigadmin/",
"/project-admins/",
"/pureadmin/",
"/_adm_/",
"/_admin_/",
"/_administrator_/",
"/author",
"/adminweb_setting",
"/kpum_aw/",
"/panel-administracion/",
"/instadmin/",
"/memberadmin/",
"/siteadmin/login.php",
"/siteadmin/index.php",
"/siteadmin/login.html",
"/bb-admin/index.php",
"/bb-admin/login.php",
"/bb-admin/admin.php",
"/developer/index.php",
"/webpanel",
"/wp-login.php",
"/signin.php",
"/signup.php",
"/admin/admin.php",
"/adminarea/login.php",
"/adminpanel.php",
"/dashboard/login.php",
"/controlpanel.php",
"/cp.php",
"/backend/login.php",
"/manage.php",
"/management.php",
"/manager.php",
"/sysadmin.php",
"/account/login.php",
"/accounts/login.php",
"/member/login.php",
"/members/login.php",
"/auth/login.php",
"/auth/signin.php",
"/auth/index.php",
"/auth.php",
"/dashboard/auth/login.php",
"/dashboard/admin/login.php",
"/admin1.php",
"/admin2.php",
"/admin3.php",
"/admin123.php",
"/admin_old.php",
"/admin-old.php",
"/admin_backup.php",
"/admin-backup.php",
"/admin_test.php",
"/admin-test.php",
"/old_admin.php",
"/old-admin.php",
"/adminprev.php",
"/admin_prev.php",
"/admin_dev.php",
"/admin-dev.php",
"/admin_stage.php",
"/admin-stage.php",
"/staging/admin/login.php",
"/test/admin/login.php",
"/dev/admin/login.php",
"/beta/admin/login.php",
"/admn/login.php",
"/admins/login.php",
"/adminstrator.php",
"/administration/login.php",
"/api/login.php",
"/api/admin/login.php",
"/api/auth/login.php",
"/api/v1/login.php",
"/api/v1/admin/login.php",
"/api/v2/login.php",
"/api/v2/admin/login.php",
"/secure/login.php",
"/secure/admin/login.php",
"/system/admin/login.php",
"/console/login.php",
"/cms/admin/login.php",
"/siteadmin/login.php"
	
)
def usage():
    print(f"Usage: {sys.argv[0]} <domain>")
    sys.exit(1)

def main():
    if len(sys.argv) < 2:
        usage()

    domain = sys.argv[1].strip()
    print(f"[+] Target: {domain}")
    print("[*] Fetching Wayback URLs...")

    session = requests.Session()
    session.headers.update({
        "User-Agent": "Mozilla/5.0"
    })

    url = ARCHIVE_URL.format(domain=domain)

    try:
        resp = session.get(url, timeout=15)
        resp.raise_for_status()
    except requests.RequestException as e:
        print(f"[!] Request error: {e}")
        sys.exit(1)

    urls = resp.text.split()

    login_results = []
    query_results = []

    for full_url in urls:
        parsed = urlparse(full_url)
        path = parsed.path.lower()

        # login page detection
        if path.startswith(LOGIN_PATHS):
            login_results.append(full_url)

        # php + query detection
        if path.endswith(".php") and parsed.query:
            query_results.append(full_url)

    if login_results:
        with open("result_login_admin.txt", "a") as f:
            f.write("\n".join(login_results) + "\n")

    if query_results:
        with open("result_query.txt", "a") as f:
            f.write("\n".join(query_results) + "\n")

    print("\n".join(
        f"{k}: {v}"
        for k, v in {
            "login": len(login_results),
            "query": len(query_results),
        }.items()
        if v
    ))

if __name__ == "__main__":
    main()
